(self.webpackChunk_use_midi_docs=self.webpackChunk_use_midi_docs||[]).push([[834],{4730:function(t,n,e){"use strict";function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}e.d(n,{Z:function(){return i}})},43758:function(t,n,e){"use strict";function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function i(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.d(n,{Z:function(){return i}})},25412:function(t,n,e){"use strict";e.d(n,{nH:function(){return B},Rx:function(){return h},Ur:function(){return q},iX:function(){return T}});var r=function(t,n){return t.forEach(n)};var i=function t(n,e){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];if(i.length>0)return t(n,e)&&t.apply(void 0,[e].concat(i));if(typeof n!=typeof e)return!1;if(t.str(n)||t.num(n))return n===e;for(var u in n)if(!(u in e))return!1;for(var a in e)if(n[a]!==e[a])return!1;return!0};i.arr=Array.isArray,i.fls=function(t){return i.und(t)||i.nul(t)||!1===t||""===t},i.nul=function(t){return null===t},i.und=function(t){return void 0===t},i.num=function(t){return"number"==typeof t},i.str=function(t){return"string"==typeof t},i.bol=function(t){return!0===t||!1===t},i.fun=function(t){return"function"==typeof t},i.obj=function(t){return!!t&&"Object"===t.constructor.name};var o,u=-1,a=!1,s=g(),c=g(),f=g(),l=g(),d=g(),p="undefined"!=typeof navigator&&"function"==typeof navigator.requestMIDIAccess?function(){return navigator.requestMIDIAccess({sysex:true,software:true})}:function(){},h=function(t){return v(t,s)};function m(t){~u&&(t.onstatechange=m,o=t.target||t,h.fun(y))}function y(){var t=u;u=h.now(),f.flush(),s.flush(t),l.flush(),c.flush(),d.flush()}function v(t,n){a?(n.delete(t),t(0)):(n.add(t),u<0&&(u=0,"demand"!==h.status&&p().then(m,h.catch)))}function g(){var t=new Set,n=t;return{add:function(n){return t.add(n)},delete:function(n){return t.delete(n)},flush:function(e){n.size&&(t=new Set,n.forEach((function(n){return n(e)&&t.add(n)})),n=t)}}}function b(t,n){Object.defineProperty(h,t,{get:function(){return n()}})}h.write=function(t){return v(t,c)},h.onStart=function(t){return v(t,f)},h.onAccess=function(t){return v(t,l)},h.onFinish=function(t){return v(t,d)},h.cancel=function(t){s.delete(t),c.delete(t)},h.sync=function(t){a=!0,h.fun(t),a=!1},h.throttle=function(t){t()},h.use=function(t){return p=t},h.now="undefined"!=typeof performance?function(){return performance.now()}:Date.now,h.fun=function(t){return t()},h.catch=console.error,h.status="always",b("access",(function(){return o})),b("inputs",(function(){var t;return null==(t=o)?void 0:t.inputs})),b("outputs",(function(){var t;return null==(t=o)?void 0:t.outputs})),h.advance=function(){"demand"!==h.status?console.warn("Cannot call the manual advancement of rmaz"):y()};"undefined"!=typeof window&&window.document&&window.document.createElement;var k=function(){function t(t){this._listeners=[],this._controller=t}var n=t.prototype;return n.add=function(t,n){h(n),this._listeners.push((function(){return h.cancel(n)}))},n.clean=function(){this._listeners.forEach((function(t){return t()})),this._listeners=[]},t}(),w=function(){function t(t){this._timeouts=new Map,this._controller=t}var n=t.prototype;return n.add=function(t,n,e){var r;void 0===e&&(e=140),this.remove(t);for(var i=arguments.length,o=new Array(i>3?i-3:0),u=3;u<i;u++)o[u-3]=arguments[u];this._timeouts.set(t,(r=window).setTimeout.apply(r,[n,e].concat(o)))},n.remove=function(t){var n=this._timeouts.get(t);n&&window.clearTimeout(n)},n.clean=function(){this._timeouts.forEach((function(t){window.clearTimeout(t)})),this._timeouts.clear()},t}(),_=e(98283),S=e(2784),A=e(43758),x=e(5491),z=e(4730),M=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(n=t.call.apply(t,[this].concat(r))||this).aliasKey="xy",n}(0,x.Z)(n,t);var e=n.prototype;return e.reset=function(){t.prototype.reset.call(this),this.state.axis=void 0},e.init=function(){this.state.offset=[0,0],this.state.lastOffset=[0,0]},e.intent=function(t){this.state;this.state.axis=this.state.axis||selectAxis(t),this.state._blocked},n}(function(){function t(t,n,e){this._ctrl=t,this._args=n,this._key=e,this.state||(this.state={values:[0,0],initial:[0,0]}),this.init&&this.init(),this.reset&&this.reset()}var n=t.prototype;return n.init=function(){this.reset()},n.reset=function(){this.state,this.shared,this.config,this._args},n.start=function(t){this.state,this.config},n.emit=function(){this.state,this.shard,this.config},n.clean=function(){this.eventStore.clean(),this.timeoutStore.clean()},n.change=function(){},n.input=function(t){},n.output=function(){},(0,z.Z)(t,[{key:"state",get:function(){return this._ctrl.state[this._key]},set:function(t){this._ctrl.state[this._key]=t}},{key:"shared",get:function(){return this._ctrl.state.shared}},{key:"eventStore",get:function(){return this._ctrl.eventStores[this._key]}},{key:"timeoutStore",get:function(){return this._ctrl.timeoutStores[this._key]}},{key:"engine",get:function(){return this._ctrl.engines[this._key]}},{key:"config",get:function(){return this._ctrl.config}}]),t}()),C=function(t){function n(){for(var n,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(n=t.call.apply(t,[this].concat(r))||this).ingKey="input",n}(0,x.Z)(n,t);var e=n.prototype;return e.reset=function(){t.prototype.reset.call(this);this.state},e.setup=function(){},e.cancel=function(){},e.clean=function(){t.prototype.clean.call(this)},e.bind=function(t){this.config.device},n}(M),E=function(t){function n(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];return t.call.apply(t,[this].concat(e))||this}return(0,x.Z)(n,t),n}(M),I=new Map,j=new Map,Z={button:{engine:C,config:{}},fader:{engine:E,config:{}},note:{engine:E,config:{}}};function D(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];r(n,(function(t){I.set(t,Z[t].engine),j.set(t,Z[t].config)}))}var N=["enabled"],O=function(){function t(t){this.keys=new Set,this._updateStore=new k(this),this._timeoutStore=new w(this),this.eventStores={},this.timeoutStores={},this.engines={},this.nativeProps={},this.props={},this.config={},this.state={shared:{}},this.props=t}var n=t.prototype;return n.clean=function(){for(var t,n=(0,A.Z)(this.keys);!(t=n()).done;){var e=t.value;this.eventStores[e].clean(),this.timeoutStores[e].clean()}},n.effect=function(){var t=this;return this.config.shared.target&&this.bind(),function(){return t._updateStore.clean(),void t._timeoutStore.clean()}},n.bind=function(){},n.applyProps=function(t,n){this.props=t,this.nativeProps=n},n.applyConfig=function(t,n){var e=t.enabled,r=(0,_.Z)(t,N),i={shared:{enabled:e}};if(n){var o=j.get(n);i[n]=Object.assign({},o,r)}else!function(t,n,e){for(var r in t)n.call(e,t[r],r)}(r,(function(t,n){var e=j.get(n);e&&(i[n]=Object.assign({},t,e))}));this.config=i},t}(),R=["children","config"];function P(t,n,e,r){void 0===n&&(n={});var i=S.useMemo((function(){return new O(t)}),[]);if(i.applyProps(t,r),i.applyConfig(n,e),S.useEffect(i.effect.bind(i)),S.useEffect((function(){return i.clean.bind(i)}),[]),void 0===n.target)return i.bind.bind(i)}function T(t,n){return void 0===n&&(n={}),D("note"),P({onNote:t},n,"note")}function q(t,n){return void 0===n&&(n={}),D("button","fader","note"),P(t,n)}function B(t){var n=t.children,e=t.config;return n(q((0,_.Z)(t,R),e))}},8819:function(t,n,e){"use strict";e.r(n),e.d(n,{frontMatter:function(){return f},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return p},midi:function(){return r},App:function(){return h},default:function(){return y}});var r,i=e(7560),o=e(98283),u=e(2784),a=e(30876),s=e(25412),c=["components"],f={sidebar_position:2,sidebar_label:"Rmaz"},l="rmaz",d={unversionedId:"rmaz",id:"rmaz",isDocsHomePage:!1,title:"rmaz",description:"Coordinate requestMIDIAccess calls across your app and/or libraries.",source:"@site/documents/rmaz.mdx",sourceDirName:".",slug:"/rmaz",permalink:"/use-midi/documents/rmaz",editUrl:"https://github.com/tseijp/use-midi/edit/master/examples/documents/rmaz.mdx",version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Rmaz"},sidebar:"tutorialSidebar",previous:{title:"Midi State",permalink:"/use-midi/documents/api/state"},next:{title:"TODO",permalink:"/use-midi/documents/todo"}},p=[{value:"Basic Examples",id:"basic-examples",children:[]}];function h(){var t=u.useState(0),n=t[0],e=t[1];u.useEffect((function(){(0,s.Rx)((function(t){return console.log(s.Rx.event),e((function(t){return t+1})),s.Rx.inputs.forEach((function(t){t.onmidimessage=function(t){s.Rx.outputs.forEach((function(n){n.send(t.data,t.timestamp)}))}})),!0}))}),[]);return(0,a.kt)(u.Fragment,null,(0,a.kt)("h4",null,"inputs"),(0,a.kt)("button",{onClick:function(){}},"add value ",n),Array.from(s.Rx.inputs||[]).map((function(t,n){return(0,a.kt)("div",{key:n},(0,a.kt)("h5",null,t[0]),(0,a.kt)("div",null,"name: ",t[1].name),(0,a.kt)("div",null,"type: ",t[1].type))})),(0,a.kt)("h4",null,"outputs"),Array.from(s.Rx.outputs||[]).map((function(t,n){return(0,a.kt)("div",{key:n},(0,a.kt)("h5",null,t[0]),(0,a.kt)("div",null,"name: ",t[1].name),(0,a.kt)("div",null,"type: ",t[1].type))})))}var m={toc:p,midi:r,App:h};function y(t){var n=t.components,e=(0,o.Z)(t,c);return(0,a.kt)("wrapper",(0,i.Z)({},m,e,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"rmaz"},"rmaz"),(0,a.kt)("p",null,"Coordinate ",(0,a.kt)("inlineCode",{parentName:"p"},"requestMIDIAccess")," calls across your app and/or libraries."),(0,a.kt)("p",null,"based on rafz: ",(0,a.kt)("inlineCode",{parentName:"p"},"requestAnimationFrame")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"raf => rma"),(0,a.kt)("li",{parentName:"ul"},"loop => change"),(0,a.kt)("li",{parentName:"ul"},"frame => access"),(0,a.kt)("li",{parentName:"ul"},"animation => midi")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { rma } from 'rmaz'\n\n// Schedule an update\nrma(ts => {})\n\n// Start an update loop\nrma(ts => true)\n\n// Cancel an update\nrma.cancel(fn)\n\n// Schedule a mutation\nrma.write(() => {})\n\n// Before any updates\nrma.onStart(() => {})\n\n// Before any mutations\nrma.onAccess(() => {})\n\n// After any mutations\nrma.onFinish(() => {})\n\n// Use a polyfill\nrma.use(require('@essentials/rma').rma)\n")),(0,a.kt)("h2",{id:"basic-examples"},"Basic Examples"),(0,a.kt)(h,{mdxType:"App"}))}y.isMDXComponent=!0}}]);